# Фреймворк модулей SDevice

Фреймворк для создания универсальных модулей с единым расширяемым интерфейсом. Также предоставляет способ логирования, проверки утверждений (assertions) и выбрасывания паник. Основной механизм, используемый фреймворком - связывание на уровне имен, для чего используются макросы.

## Создание нового модуля

### Публичный интерфейс

Для определения публичного интерфейса используется заголовочный файл этой библиотеки `core.h`.

### Приватный интерфейс

Для определения приватного интерфейса используется заголовочный файл публичного интерфейса.

### Реализация интерфейса

При реализации интерфейса используется заголовочный файл приватной его части (она уже включает в себя публичную).

## Обработка ошибок и логирование

Средства, используемые для обработки ошибок, проверки утверждений и логирования содержатся в заголовочном файле `errors.h`.

### Проверка утверждений (assertions)

Для проверки утверждений используются два макроса:

* `SDeviceAssert()` - для проверки значений, передаваемых пользователем модуля
* `SDeviceDebugAssert()` - для проверки внутренних значений модуля

Такое разделение позволит сократить объем кода в отладочной версии конечного приложения, отключив проверку утверждений, переданных в `SDeviceDebugAssert()`. В оптимизированной же версии конечного приложения имеет смысл полностью отключить проверку утверждений.

### Логирование

Логирование состояний происходит с помощью макроса `SDeviceLogStatus()` (и `SDeviceLogStatusWithExtras()`). Данный макрос вызывает процедуру `SDeviceProcessLogStatus()`, которая может быть переопределена.

### Паники

Для обработки исключительных ситуаций, в библиотеке предусмотрен механизм паник (`SDevicePanic()`). 
В случае выбрасывания паники произойдет вызов функции `SDeviceProcessPanic()`, которая может быть переопределена.

## Динамическое выделение памяти

При создании (и удалении) экземпляров модулей используются механизм динамического выделения памяти, реализованный процедурами `SDeviceMalloc()` и `SDeviceFree()`. Обе функции могут быть переопределены.
